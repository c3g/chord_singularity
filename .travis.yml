language: go

go:
  - 1.12.x

python:
  - 3.7

before_install:
  - sudo apt-get update
  - sudo apt-get install -y build-essential libssl-dev uuid-dev libseccomp-dev pkg-config squashfs-tools cryptsetup
  - mkdir -p ${GOPATH}/src/github.com/sylabs
  - cd ${GOPATH}/src/github.com/sylabs
  - git clone https://github.com/sylabs/singularity.git
  - cd singularity
  - git checkout v3.4.1
  - ./mconfig
  - cd ./builddir
  - make
  - sudo make install

script:
  - sudo python3 ./dev_utils.py build
